import{c as se,a as F,j as s,r as te,H as ae}from"./app-Ci7CDRNd.js";import{A as le}from"./mobile-layout-C3OyDd1n.js";import{B as z}from"./index-BLUAye1L.js";import{a as M,b as O,c as q,S as J,d as Z}from"./select-C8NgR5qa.js";import{T as re}from"./textarea-4XlttD-2.js";import{C as Q,a as W}from"./card-Dxrba-Q_.js";import{A as oe}from"./arrow-right-B-jmD_Xq.js";import{G as X}from"./graduation-cap-Dz_krzqH.js";import{R as ie}from"./rotate-ccw-DCMhwnd7.js";import{T as Y}from"./trending-up-Cj9WNasM.js";import{U as ne}from"./users-vzg2hPAy.js";import{S as me}from"./save-By1SNXAC.js";/* empty css            */import"./app-sidebar-CPzjeIVL.js";import"./x-B-c32jvu.js";import"./index-i1tW4-ja.js";import"./layout-dashboard-CjqitNLP.js";import"./index-CLv57PmX.js";import"./chevron-down-CNcQHhh-.js";import"./check-DhXh2-Vo.js";function Ge(t){const e=se.c(47),{classGroup:a,enrollments:i,nextTermClassGroups:_,statuses:g}=t;let S;e[0]!==i?(S=i.map(pe),e[0]=i,e[1]=S):S=e[1];const[n,D]=F.useState(S),[N,H]=F.useState(!1);let y;e[2]===Symbol.for("react.memo_cache_sentinel")?(y=(o,l,G)=>{D(m=>m.map(r=>r.enrollment_id===o?{...r,[l]:G}:r))},e[2]=y):y=e[2];const P=y;let b;e[3]===Symbol.for("react.memo_cache_sentinel")?(b=o=>{D(l=>l.map(G=>({...G,status:o})))},e[3]=b):b=e[3];const L=b;let v;e[4]!==a.id||e[5]!==n?(v=o=>{o.preventDefault(),H(!0),te.post(`/admin/class-promotions/${a.id}/process`,{promotions:n},{onFinish:()=>H(!1)})},e[4]=a.id,e[5]=n,e[6]=v):v=e[6];const U=v;let w;e[7]===Symbol.for("react.memo_cache_sentinel")?(w={promoted:s.jsx(Y,{className:"w-4 h-4 text-green-500"}),retained:s.jsx(ie,{className:"w-4 h-4 text-red-500"}),graduated:s.jsx(X,{className:"w-4 h-4 text-purple-500"}),transferred:s.jsx(oe,{className:"w-4 h-4 text-gray-500"})},e[7]=w):w=e[7];const ee=w,$=`Kenaikan Kelas - ${a.name}`,E=`Kenaikan Kelas - ${a.name}`;let c;e[8]!==E?(c=s.jsx(ae,{title:E}),e[8]=E,e[9]=c):c=e[9];let C;e[10]===Symbol.for("react.memo_cache_sentinel")?(C=s.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:s.jsx(ne,{className:"w-6 h-6 text-primary"})}),e[10]=C):C=e[10];let d;e[11]!==a.name?(d=s.jsx("p",{className:"font-medium",children:a.name}),e[11]=a.name,e[12]=d):d=e[12];const I=a.term?.name;let p;e[13]!==i.length||e[14]!==I?(p=s.jsxs("p",{className:"text-sm text-muted-foreground",children:[I," â€¢ ",i.length," siswa"]}),e[13]=i.length,e[14]=I,e[15]=p):p=e[15];let u;e[16]!==d||e[17]!==p?(u=s.jsx(Q,{children:s.jsx(W,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[C,s.jsxs("div",{children:[d,p]})]})})}),e[16]=d,e[17]=p,e[18]=u):u=e[18];let k;e[19]===Symbol.for("react.memo_cache_sentinel")?(k=()=>L("promoted"),e[19]=k):k=e[19];let K;e[20]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsxs(z,{variant:"outline",size:"sm",onClick:k,className:"gap-1",children:[s.jsx(Y,{className:"w-4 h-4"}),"Semua Naik"]}),e[20]=K):K=e[20];let T;e[21]===Symbol.for("react.memo_cache_sentinel")?(T=()=>L("graduated"),e[21]=T):T=e[21];let R;e[22]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[K,s.jsxs(z,{variant:"outline",size:"sm",onClick:T,className:"gap-1",children:[s.jsx(X,{className:"w-4 h-4"}),"Semua Lulus"]})]}),e[22]=R):R=e[22];let f;if(e[23]!==i||e[24]!==_||e[25]!==n||e[26]!==g){let o;e[28]!==_||e[29]!==n||e[30]!==g?(o=(l,G)=>{const m=n.find(r=>r.enrollment_id===l.id);return s.jsx(Q,{children:s.jsxs(W,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:ee[m?.status||"promoted"]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:l.student?.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["NIS: ",l.student?.nis]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(M,{value:m?.status||"promoted",onValueChange:r=>P(l.id,"status",r),children:[s.jsx(O,{children:s.jsx(q,{placeholder:"Status"})}),s.jsx(J,{children:Object.entries(g).map(de)})]}),(m?.status==="promoted"||m?.status==="retained")&&s.jsxs(M,{value:m?.to_class_group_id||"",onValueChange:r=>P(l.id,"to_class_group_id",r),children:[s.jsx(O,{children:s.jsx(q,{placeholder:"Kelas Tujuan"})}),s.jsx(J,{children:_.map(ce)})]})]}),s.jsx(re,{placeholder:"Catatan (opsional)",value:m?.notes||"",onChange:r=>P(l.id,"notes",r.target.value),rows:2})]})},l.id)},e[28]=_,e[29]=n,e[30]=g,e[31]=o):o=e[31],f=i.map(o),e[23]=i,e[24]=_,e[25]=n,e[26]=g,e[27]=f}else f=e[27];let A;e[32]===Symbol.for("react.memo_cache_sentinel")?(A=s.jsx(me,{className:"w-5 h-5"}),e[32]=A):A=e[32];const V=N?"Memproses...":"Simpan Kenaikan Kelas";let x;e[33]!==N||e[34]!==V?(x=s.jsxs(z,{type:"submit",disabled:N,className:"w-full gap-2",children:[A,V]}),e[33]=N,e[34]=V,e[35]=x):x=e[35];let h;e[36]!==U||e[37]!==f||e[38]!==x?(h=s.jsxs("form",{onSubmit:U,className:"space-y-4",children:[f,x]}),e[36]=U,e[37]=f,e[38]=x,e[39]=h):h=e[39];let j;e[40]!==u||e[41]!==h?(j=s.jsxs("div",{className:"m3-container py-6 space-y-6",children:[u,R,h]}),e[40]=u,e[41]=h,e[42]=j):j=e[42];let B;return e[43]!==j||e[44]!==$||e[45]!==c?(B=s.jsxs(le,{title:$,showBack:!0,backUrl:"/admin/class-promotions",children:[c,j]}),e[43]=j,e[44]=$,e[45]=c,e[46]=B):B=e[46],B}function ce(t){return s.jsxs(Z,{value:t.id.toString(),children:[t.name," - ",t.term?.name]},t.id)}function de(t){const[e,a]=t;return s.jsx(Z,{value:e,children:a},e)}function pe(t){return{enrollment_id:t.id,status:t.promotion?.status||"promoted",to_class_group_id:t.promotion?.to_class_group_id?.toString()||"",notes:t.promotion?.notes||""}}export{Ge as default};
